
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://roadmappers.ru/SPARK/BASE/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Index - Roadmappers</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Roadmappers" class="md-header__button md-logo" aria-label="Roadmappers" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Roadmappers
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/halltape/HalltapeRoadmapDE" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Roadmappers.ru
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Roadmappers" class="md-nav__button md-logo" aria-label="Roadmappers" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Roadmappers
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/halltape/HalltapeRoadmapDE" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Roadmappers.ru
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Главная
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Обо мне
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Контакты
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Куратор раздела
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Spark?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Что такое Spark?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apache-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Откуда может читать данные Apache Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Откуда может читать данные Apache Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      Файловые системы
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Форматы файлов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Базы данных и хранилища (через коннекторы)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Системы стриминга
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Другие источники через коннекторы и плагины
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      А в чем разница между Spark и Pandas?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_1" class="md-nav__link">
    <span class="md-ellipsis">
      Где запускается Spark?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_2" class="md-nav__link">
    <span class="md-ellipsis">
      Из чего состоит Spark?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_3" class="md-nav__link">
    <span class="md-ellipsis">
      Как Spark читает данные?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shuffle" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Shuffle?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executors" class="md-nav__link">
    <span class="md-ellipsis">
      Сколько нужно выделять executors?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_4" class="md-nav__link">
    <span class="md-ellipsis">
      На что расходуется память в Spark?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-ui" class="md-nav__link">
    <span class="md-ellipsis">
      Есть ли у Spark UI?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark_5" class="md-nav__link">
    <span class="md-ellipsis">
      Где учить Spark?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h2 id="_1">Куратор раздела</h2>
<p><img align="left" width="200" src="../../png/halltape.jpg" /></p>
<p><strong>Виндюков Евгений</strong>, 
                                                                                                                      <em>Data Engineer</em></p>
<p><a href="https://t.me/halltape_data">Канал Я – Дата Инженер</a></p>
<p>Если нужна помощь в обучении или в составлении резюме – пиши <a href="https://t.me/halltape">@halltape</a></p>
<p>Хочешь улучшить текущий раздел, внести недостающее или поправить формулировку? Предлагай PR и тегай <a href="https://github.com/halltape">@halltape</a></p>
<h1 id="spark">Что такое Spark?</h1>
<p align="center">
    <img src="../../png/spark.png" alt="spark" width="800"/>
</p>

<p><strong>Apache Spark</strong> - это супер быстрый фреймворк. Нужен он для того, чтобы обрабатывать большие данные на огромных кластерах (нескольких серверах). Работает он до 100 раз быстрее, чем Hadoop MapReduce в памяти или в 10 раз быстрее, чем на диске.</p>
<p>Визуально его код выглядит так, будто скрестили SQL и Python:</p>
<p align="center">
    <img src="../../png/spark_images/SPARK.002.jpeg" alt="spark" width="800"/>
</p>

<hr />
<h2 id="apache-spark">Откуда может читать данные Apache Spark</h2>
<h3 id="_2">Файловые системы</h3>
<ul>
<li><strong>HDFS</strong></li>
<li><strong>S3</strong> </li>
<li><strong>Локальная файловая система</strong></li>
<li><strong>Azure Blob Storage</strong>, <strong>ADLS</strong> (Azure Data Lake Storage)</li>
<li><strong>Google Cloud Storage</strong></li>
</ul>
<h3 id="_3">Форматы файлов</h3>
<ul>
<li><strong>CSV</strong></li>
<li><strong>JSON</strong></li>
<li><strong>Parquet</strong></li>
<li><strong>ORC</strong></li>
<li><strong>Avro</strong></li>
<li><strong>Text</strong></li>
</ul>
<h3 id="_4">Базы данных и хранилища (через коннекторы)</h3>
<ul>
<li><strong>JDBC</strong> (PostgreSQL, MySQL, MSSQL и другие базы)</li>
<li><strong>ClickHouse</strong></li>
<li><strong>Greenplum</strong></li>
<li><strong>Hive</strong></li>
<li><strong>HBase</strong></li>
<li><strong>Cassandra</strong></li>
<li><strong>MongoDB</strong></li>
<li><strong>Elasticsearch</strong></li>
</ul>
<h3 id="_5">Системы стриминга</h3>
<ul>
<li><strong>Kafka</strong></li>
<li><strong>Kinesis</strong> (AWS)</li>
</ul>
<h3 id="_6">Другие источники через коннекторы и плагины</h3>
<ul>
<li><strong>Delta Lake</strong></li>
<li><strong>Iceberg</strong></li>
<li><strong>Hudi</strong></li>
<li><strong>Google BigQuery</strong></li>
</ul>
<p align="center">
    <img src="../../png/spark_images/SPARK.003.jpeg" alt="spark" width="800"/>
</p>
<p>и так далее...</p>
<hr />
<h2 id="spark-pandas">А в чем разница между Spark и Pandas?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.004.jpeg" alt="spark" width="800"/>
</p>

<p>Внешне код на pandas и на spark действительно похожи. Но pandas работает на одной машине и иногда дата инженеры могут его использовать для обработки маленьких кусочков данных (например из API), когда данные помещаются в оперативную память одного компьютера.</p>
<hr />
<h2 id="spark_1">Где запускается Spark?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.005.jpeg" alt="spark" width="800"/>
</p>

<p>На работе под вашу команду будет выделено некоторое кол-во серверов. Собственно это физически может быть несколько стоек с серверами. Именно на них и будет запускаться ваш Spark. В бигтехах (больших компаниях, типа Банки) вы можете пользоваться коммунальным кластером. Это значит, что помимо вас, этими ресурсами будут пользоваться несколько команд. Соответственно здесь надо будет грамотно рассчитывать используемые ресурсы серверов, чтобы дать считать свои данные и другим. Подробнее про ресурсы будет пониже.</p>
<hr />
<h2 id="spark_2">Из чего состоит Spark?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.006.jpeg" alt="spark" width="800"/>
</p>

<p align="center">
    <img src="../../png/spark_images/SPARK.007.jpeg" alt="spark" width="800"/>
</p>

<p>Если очень просто, то для того, чтобы посчитать сборку витрины данных, вам нужно будет запустить Spark приложение с конкретным кол-вом CPU и RAM. Эти значения вы указываете самостоятельно. Очевидно, что если вы укажите слишком много, то это может занять весь КЛАСТЕР. Таким образом вы отберете ресурсы от других пользователей. Поэтому в Spark нужно уже начинать думать об этом заранее.</p>
<hr />
<h2 id="spark_3">Как Spark читает данные?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.008.jpeg" alt="spark" width="800"/>
</p>

<p>Spark можно очень гибко настраивать, но по умолчанию он часто читает файл и разбивает его на кусочки (типа на 128Мб). Этот параметр может меняться в зависимости от источника, настроек системы и так далее. Возьмем вариант в 128Mb.</p>
<p><strong>Исходные данные:</strong>
- Файл весом <strong>10 Gb</strong>
- <strong>8 серверов</strong> (один сервер: 2 ядра CPU и 16Gb RAM)</p>
<p><strong>В Spark:</strong>
- 1 ядро (core) может выполнять 1 задачу (task) одновременно.
- Установим каждому executor’у 2 ядра, тогда он может одновременно обрабатывать 2 tasks.</p>
<p><strong>ВАЖНО!</strong></p>
<p>Мы можем вручную указать кол-во executors и выделяемое им кол-во CPU и RAM.
Совершенно необязательно, что на одном сервере будет запускаться один executor. Если хватает CPU и RAM для двух и более, то запуститься сразу несколько.</p>
<p align="center">
    <img src="../../png/spark_images/SPARK.010.jpeg" alt="spark" width="800"/>
</p>

<div class="codehilite"><pre><span></span><code>Если Spark читает файл размером 10Gb, значит он поделит его на
10 * 1024 Mb / 128 Mb = 80 partitions
</code></pre></div>

<p><strong>Что получаем:</strong>
- Кластер может одновременно обрабатывать 16 tasks (8 серверов по 2 tasks).
- Поскольку партций 80, Spark сначала запустит 16 задач параллельно (на 8 executors).
- Как только один task завершается, на освободившемся ядре сразу стартует следующий task.
- И так, пока все 80 партций не будут обработаны.</p>
<p>Т.е. наш Spark уже при чтении разбил данные на небольшие кусочки и раскидал их по серверам, чтобы обработать их параллельно. Важный момент, что кол-во executors мы можем, как увеличить, так и уменьшить. Это позволяет напрямую влиять на скорость обработки данных.</p>
<hr />
<h2 id="shuffle">Что такое Shuffle?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.009.jpeg" alt="spark" width="800"/>
</p>

<p>Shuffle происходит, когда Spark нужно перемешать данные между executor, например для выполнения операции JOIN и так далее. Представьте, что данные с одним и тем же ключем для join у вас лежат на разных executors. Очевидно, что нужно все перетасовать между собой. Более подробное объяснения можете почитать <a href="../ADVANCED/#Shuffle-в-Spark">тут</a> !</p>
<hr />
<h2 id="executors">Сколько нужно выделять executors?</h2>
<p>Ниже небольшое объяснение, почему слишком большое или слишком маленькое кол-во executors не всегда хорошо. На практике, особенно на junior позициях, вам не придется сильно заморачиваться с расчетом ресурсов. Ваш TeamLead выдаст вам готовый конфиг с уже настроенными параметрами. Ваша задача будет только запустить его. Но если вас спросят об этом на собесе – это будет огромным плюсом!</p>
<p align="center">
    <img src="../../png/spark_images/SPARK.011.jpeg" alt="spark" width="800"/>
</p>

<p align="center">
    <img src="../../png/spark_images/SPARK.012.jpeg" alt="spark" width="800"/>
</p>

<p>Ниже по ссылке можете посмотреть, как рассчитываются ресурсы для Spark приложения:
- <a href="https://sparkconfigoptimizer.com">Онлайн расчет ресурсов для Spark</a></p>
<hr />
<h2 id="spark_4">На что расходуется память в Spark?</h2>
<p align="center">
    <img src="../../png/spark_images/SPARK.013.jpeg" alt="spark" width="800"/>
</p>

<p>Эта информация скорее для Advanced уровня и о ней почти не спрашивают на собесах. Это понадобится вам только в том случае, когда вы начнете вручную настраивать кол-во выделяемых ресурсов для executor и увидите, что ваши Gb на самом деле пилятся внутри Spark еще на много чего полезного. Условно, будто вы купили диск на 1Gb, а в реальности там оказалось только 500Мб полезной нагрузки.</p>
<hr />
<h2 id="spark-ui">Есть ли у Spark UI?</h2>
<p>Да, у Spark есть интерфейс, где можно отслеживать план выполнения вашего запроса. Это реально удобная вещь. Визуально это выглядит вот так:</p>
<p align="center">
    <img src="../../png/spark_images/spark_ui.png" alt="spark" width="800"/>
</p>

<p>Для того, чтобы разобраться еще и в UI, ниже хорошая статья:
- <a href="https://habr.com/ru/companies/avito/articles/764996/">Как пользоваться Spark UI?</a></p>
<hr />
<h2 id="spark_5">Где учить Spark?</h2>
<p>Одна из хороших практик для обучения - переписывать запросы с SQL на Spark и наоборот.
Результаты, очевидно, должны быть одинаковыми.</p>
<p><strong>Вот пример двух одинаковых запросов на SQL и на PySpark</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">SELECT</span>
<span class="w">    </span><span class="n">d</span><span class="p">.</span><span class="n">department_name</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">salary</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_salary</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">employees</span><span class="w"> </span><span class="n">e</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">departments</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">department_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">department_id</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">salaries</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">employee_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">salary</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">3000</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">department_name</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">average_salary</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">result_df</span> <span class="o">=</span> <span class="n">employees_df</span>\
                <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">departments_df</span><span class="p">,</span> <span class="s2">&quot;department_id&quot;</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">salaries_df</span><span class="p">,</span> <span class="s2">&quot;employee_id&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">salaries_df</span><span class="o">.</span><span class="n">salary</span> <span class="o">&gt;=</span> <span class="mi">3000</span><span class="p">)</span>
                <span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="s2">&quot;department_name&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">avg</span><span class="p">(</span><span class="s2">&quot;salary&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;average_salary&quot;</span><span class="p">))</span>
                <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s2">&quot;average_salary&quot;</span><span class="p">))</span>
<span class="n">result_df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

<p>Также рекомендую порешать несколько задачек отсюда:</p>
<p>➜ <a href="https://platform.stratascratch.com/coding?code_type=6">Leetcode по PySpark</a></p>
<p>Чтобы попробовать Spark локально, можно развернуть мини кластер у себя локально:</p>
<p>➜ <a href="https://github.com/halltape/HalltapeSparkCluster/tree/main">Разверни свой Spark кластер</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      MIT
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../js/toc-home.js"></script>
      
    
  </body>
</html>